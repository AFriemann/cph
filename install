#!/bin/sh

CC=gcc
CFLAGS="-g -Wall -o"
LDFLAGS=

PKGCFG=

MAINFOLDER="src/core"
TESTFOLDER="src/test"

MAINSOURCE="$MAINFOLDER/psafe.c"
SUPPSOURCES="$MAINFOLDER/psafeKey.c $MAINFOLDER/literalOperations.c $MAINFOLDER/arrayOperations.c $MAINFOLDER/psafeInputHandler.c $MAINFOLDER/psafeClipboardHandler.c"

MAINBIN="psafe"
TESTBIN="test"

BIN=
SOURCES=

function compile {
  ($CC $CFLAGS $BIN $SOURCES $PKGCFG)
  return $?
}

function setMainSources {
  BIN=$MAINBIN
  SOURCES="$MAINSOURCE $SUPPSOURCES"
  PKGCFG="`pkg-config --cflags --libs gtk+-3.0`"
}

function setTestSources {
  BIN=$TESTBIN
  SOURCES="$TESTFOLDER/psafeTests.c $TESTFOLDER/psafeKeyTests.c $TESTFOLDER/arrayOperationsTests.c $TESTFOLDER/literalOperationsTests.c $SUPPSOURCES"
  PKGCFG="`pkg-config --cflags --libs cunit gtk+-3.0`"
}

case "$1" in
  test )
    setTestSources
    compile
    exit $?
    ;;
  clean )
    rm -f $MAINBIN $TESTBIN
    exit 0
    ;;
  * )
    setMainSources
    compile
    exit $?
    ;;
esac

